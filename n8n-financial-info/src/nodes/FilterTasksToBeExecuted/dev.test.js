/**
 * Teste de desenvolvimento manual para FilterTasksToBeExecuted
 * Edite as tasks, executions e emails abaixo para testar cen√°rios espec√≠ficos
 */

const {
  filterTasksToExecute
} = require('./index');

describe('Teste de desenvolvimento manual', () => {
  it('deve executar tasks conforme configura√ß√£o manual', () => {
    // ========================================
    // EDITE AQUI: Lista de tasks
    // ========================================
    const tasks = [
      {
        "row_number": 2,
        "Id": 1,
        "Subject": "Jantas da Semana",
        "ScheduledType": "WEEKLY",
        "ScheduledPeriod": 1,
        "ScheduledDay": "Saturday",
        "ScheduledTime": "09:00",
        "Prompt": "Gere apenas HTML v√°lido, sem Markdown, sem ``` e sem texto explicativo.\n\nCrie um e-mail com o seguinte conte√∫do:\n\nAssunto: ‚ÄúCard√°pio Saud√°vel e Proteico da Semana‚Äù\n\nUma breve introdu√ß√£o motivacional sobre alimenta√ß√£o equilibrada.\n\nUm card√°pio semanal completo, organizado por dias da semana (segunda a domingo).\n\nPara cada dia, liste ideias para Caf√© da Manh√£, Lanches, Almo√ßo e Jantar, priorizando op√ß√µes com boa quantidade de prote√≠na e baixas calorias.\n\nUse HTML inline, com boa legibilidade e estrutura limpa para e-mail.\n\nEstrutura esperada (responda apenas com o HTML completo):\n\n(n√£o inclua este coment√°rio no resultado)\n\n<html> <body style=\"font-family: Arial, sans-serif; color:#222; margin:0; padding:24px; background:#f9fafb;\"> <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"max-width:700px; margin:auto; background:#ffffff; border:1px solid #e5e7eb; border-radius:8px;\"> <tr> <td style=\"padding:24px;\"> <h1 style=\"font-size:20px; margin-bottom:8px;\">Card√°pio Saud√°vel e Proteico da Semana</h1> <p style=\"font-size:14px; color:#555;\"> Ol√° [Nome do Destinat√°rio], </p> <p style=\"font-size:14px; color:#555; margin-bottom:20px;\"> Para te ajudar a manter uma alimenta√ß√£o equilibrada e rica em prote√≠nas, preparei um card√°pio semanal com ideias de refei√ß√µes leves, nutritivas e de baixa caloria. üí™ü•ó </p>\n      <!-- Loop de dias da semana -->\n      <h2 style=\"font-size:16px; margin-top:24px; color:#111;\">Segunda-feira</h2>\n      <ul style=\"font-size:14px; color:#333; padding-left:20px; margin-bottom:16px;\">\n        <li><strong>Caf√© da manh√£:</strong> Omelete com claras e espinafre + caf√© sem a√ß√∫car</li>\n        <li><strong>Lanche:</strong> Iogurte grego zero com morangos</li>\n        <li><strong>Almo√ßo:</strong> Frango grelhado, arroz integral e legumes no vapor</li>\n        <li><strong>Jantar:</strong> Sopa de lentilhas com frango desfiado</li>\n      </ul>\n\n      <h2 style=\"font-size:16px; margin-top:16px; color:#111;\">Ter√ßa-feira</h2>\n      <ul style=\"font-size:14px; color:#333; padding-left:20px; margin-bottom:16px;\">\n        <li><strong>Caf√© da manh√£:</strong> Tapioca com ovo mexido e queijo branco</li>\n        <li><strong>Lanche:</strong> Mix de castanhas e uma ma√ß√£</li>\n        <li><strong>Almo√ßo:</strong> Peixe grelhado com pur√™ de couve-flor</li>\n        <li><strong>Jantar:</strong> Salada com atum, gr√£o-de-bico e azeite</li>\n      </ul>\n\n      <h2 style=\"font-size:16px; margin-top:16px; color:#111;\">Quarta-feira</h2>\n      <ul style=\"font-size:14px; color:#333; padding-left:20px; margin-bottom:16px;\">\n        <li><strong>Caf√© da manh√£:</strong> Panqueca de banana com aveia e whey</li>\n        <li><strong>Lanche:</strong> Queijo cottage com frutas vermelhas</li>\n        <li><strong>Almo√ßo:</strong> Carne magra com salada de quinoa e legumes</li>\n        <li><strong>Jantar:</strong> Omelete de claras com br√≥colis</li>\n      </ul>\n\n      <h2 style=\"font-size:16px; margin-top:16px; color:#111;\">Quinta-feira</h2>\n      <ul style=\"font-size:14px; color:#333; padding-left:20px; margin-bottom:16px;\">\n        <li><strong>Caf√© da manh√£:</strong> Smoothie de prote√≠na com banana e pasta de amendoim</li>\n        <li><strong>Lanche:</strong> Ovo cozido e cenourinhas baby</li>\n        <li><strong>Almo√ßo:</strong> Peito de frango, arroz integral e ab√≥bora assada</li>\n        <li><strong>Jantar:</strong> Til√°pia com salada verde e tomate-cereja</li>\n      </ul>\n\n      <h2 style=\"font-size:16px; margin-top:16px; color:#111;\">Sexta-feira</h2>\n      <ul style=\"font-size:14px; color:#333; padding-left:20px; margin-bottom:16px;\">\n        <li><strong>Caf√© da manh√£:</strong> Overnight oats com chia e whey</li>\n        <li><strong>Lanche:</strong> Barra de prote√≠na e uma tangerina</li>\n        <li><strong>Almo√ßo:</strong> Carne de panela magra com feij√£o e legumes</li>\n        <li><strong>Jantar:</strong> Omelete com cogumelos e queijo minas</li>\n      </ul>\n\n      <h2 style=\"font-size:16px; margin-top:16px; color:#111;\">S√°bado</h2>\n      <ul style=\"font-size:14px; color:#333; padding-left:20px; margin-bottom:16px;\">\n        <li><strong>Caf√© da manh√£:</strong> P√£o integral com peito de peru e caf√© preto</li>\n        <li><strong>Lanche:</strong> Iogurte zero e nozes</li>\n        <li><strong>Almo√ßo:</strong> Fil√© de peixe, pur√™ de batata-doce e legumes grelhados</li>\n        <li><strong>Jantar:</strong> Sopa leve de legumes com frango</li>\n      </ul>\n\n      <h2 style=\"font-size:16px; margin-top:16px; color:#111;\">Domingo</h2>\n      <ul style=\"font-size:14px; color:#333; padding-left:20px; margin-bottom:16px;\">\n        <li><strong>Caf√© da manh√£:</strong> Panqueca de aveia e claras com frutas</li>\n        <li><strong>Lanche:</strong> Iogurte grego com granola light</li>\n        <li><strong>Almo√ßo:</strong> Frango assado com arroz integral e salada colorida</li>\n        <li><strong>Jantar:</strong> Omelete de claras com espinafre e ricota</li>\n      </ul>\n\n      <p style=\"font-size:14px; color:#555; margin-top:24px;\">\n        Que esse card√°pio te inspire a manter uma rotina saud√°vel, equilibrada e cheia de energia! üåøüí™\n      </p>\n\n      <p style=\"font-size:14px; color:#555; margin-top:20px;\">\n        Com sa√∫de,<br><strong>L√©o Dias</strong>\n      </p>\n    </td>\n  </tr>\n</table>\n\n</body> </html>"
      },
      {
        "row_number": 3,
        "Id": 2,
        "Subject": "Estoicismo",
        "ScheduledType": "DAILY",
        "ScheduledPeriod": 1,
        "ScheduledDay": 1,
        "ScheduledTime": "08:00",
        "Prompt": "Gere apenas HTML, sem Markdown, sem ``` e sem texto explicativo.\n\nCrie um e-mail com o seguinte formato:\n\nAssunto: ‚ÄúSabedoria Estoica para o Dia a Dia‚Äù\n\nCumprimento e breve introdu√ß√£o inspiradora.\n\nListe 5 frases de fil√≥sofos estoicos (Marco Aur√©lio, S√™neca, Epicteto, etc.), cada uma com:\n\na frase em destaque,\n\no autor,\n\ne uma breve reflex√£o sobre seu significado.\n\nFinalize com uma despedida e assinatura.\n\nUse HTML inline (sem classes ou CSS externo).\n\nEstruture assim (responda apenas com o HTML completo):\n\n(n√£o inclua este coment√°rio no resultado)\n\n<html> <body style=\"font-family: Arial, sans-serif; color:#222; margin:0; padding:24px; background:#f9fafb;\"> <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"max-width:700px; margin:auto; background:#ffffff; border:1px solid #e5e7eb; border-radius:8px;\"> <tr> <td style=\"padding:24px;\"> <h1 style=\"font-size:20px; margin-bottom:8px;\">Sabedoria Estoica para o Dia a Dia</h1> <p style=\"font-size:14px; color:#555;\">Ol√° [Nome do Destinat√°rio],</p> <p style=\"font-size:14px; color:#555; margin-bottom:20px;\"> Espero que este e-mail te encontre bem! Separei cinco frases de grandes fil√≥sofos estoicos que nos lembram o valor da serenidade, da raz√£o e do foco no que podemos controlar. </p>\n      <ol style=\"padding-left:20px; margin-bottom:24px; font-size:14px; color:#333;\">\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúAlgumas coisas est√£o sob nosso controle, e outras n√£o.‚Äù</strong> ‚Äî <em>Epicteto</em><br>\n          <span style=\"color:#666;\">Um lembrete poderoso para concentrar nossa energia apenas no que depende de n√≥s.</span>\n        </li>\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúO obst√°culo para a a√ß√£o avan√ßa a a√ß√£o. O que est√° no caminho torna-se o caminho.‚Äù</strong> ‚Äî <em>Marco Aur√©lio</em><br>\n          <span style=\"color:#666;\">Um convite para transformar desafios em oportunidades de crescimento.</span>\n        </li>\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúSofremos mais frequentemente na imagina√ß√£o do que na realidade.‚Äù</strong> ‚Äî <em>S√™neca</em><br>\n          <span style=\"color:#666;\">Um lembrete para n√£o deixar que preocupa√ß√µes irreais dominem nossa mente.</span>\n        </li>\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúN√£o √© o que acontece com voc√™ que importa, mas como voc√™ reage a isso.‚Äù</strong> ‚Äî <em>Epicteto</em><br>\n          <span style=\"color:#666;\">A ess√™ncia da resili√™ncia ‚Äî o poder est√° sempre em nossa resposta.</span>\n        </li>\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúN√£o deseje que as coisas aconte√ßam do seu jeito, mas deseje que elas aconte√ßam como acontecem.‚Äù</strong> ‚Äî <em>Epicteto</em><br>\n          <span style=\"color:#666;\">Aceitar a realidade como ela √© nos aproxima da verdadeira paz interior.</span>\n        </li>\n      </ol>\n\n      <p style=\"font-size:14px; color:#555;\">\n        Que essas reflex√µes tragam um pouco de calma e clareza ao seu dia.\n      </p>\n\n      <p style=\"font-size:14px; color:#555; margin-top:20px;\">Com serenidade,<br><strong>L√©o Dias</strong></p>\n    </td>\n  </tr>\n</table>\n\n</body> </html>"
      },
      {
        "row_number": 4,
        "Id": 3,
        "Subject": "Dicas de Livros",
        "ScheduledType": "MOUNTHLY",
        "ScheduledPeriod": 1,
        "ScheduledDay": 1,
        "ScheduledTime": "08:00",
        "Prompt": "Gere apenas HTML v√°lido, sem Markdown, sem ``` e sem texto explicativo.\n\nCrie um e-mail com o seguinte formato:\n\nAssunto: ‚ÄúDicas de Livros Imperd√≠veis para a Pr√≥xima Leitura‚Äù\n\nUma breve introdu√ß√£o inspiradora sobre leitura e imagina√ß√£o.\n\nUma lista de 5 livros recomendados, preferencialmente de autores como Dan Brown, John Scalzi, George R. R. Martin, Carlos Ruiz Zaf√≥n, Philip Pullman, ou autores com estilo semelhante.\n\nPara cada livro, inclua:\n\nT√≠tulo\n\nAutor\n\nBreve sinopse (m√°x. 3 linhas)\n\nUm motivo para ler (por exemplo, ‚Äú√≥tima trama de mist√©rio‚Äù, ‚Äúuniverso fant√°stico‚Äù, etc.)\n\nFinalize com uma mensagem de incentivo √† leitura.\n\nUse HTML inline, limpo e compat√≠vel com clientes de e-mail.\n\nEstrutura esperada (responda apenas com o HTML completo):\n\n(n√£o inclua este coment√°rio no resultado)\n\n<html> <body style=\"font-family: Arial, sans-serif; color:#222; margin:0; padding:24px; background:#f9fafb;\"> <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"max-width:700px; margin:auto; background:#ffffff; border:1px solid #e5e7eb; border-radius:8px;\"> <tr> <td style=\"padding:24px;\"> <h1 style=\"font-size:20px; margin-bottom:8px;\">Dicas de Livros Imperd√≠veis para a Pr√≥xima Leitura</h1> <p style=\"font-size:14px; color:#555;\"> Ol√° [Nome do Destinat√°rio], </p> <p style=\"font-size:14px; color:#555; margin-bottom:20px;\"> Se voc√™ curte hist√≥rias cheias de mist√©rio, mundos fant√°sticos e tramas inteligentes, preparei uma sele√ß√£o com 5 livros que v√£o te prender do in√≠cio ao fim. üìö‚ú® </p>\n      <!-- Lista de livros -->\n      <div style=\"margin-bottom:20px;\">\n        <h2 style=\"font-size:16px; color:#111; margin-bottom:4px;\">1. O S√≠mbolo Perdido</h2>\n        <p style=\"margin:0; font-size:14px; color:#555;\"><strong>Autor:</strong> Dan Brown</p>\n        <p style=\"font-size:14px; color:#333; margin:8px 0;\">\n          Um mergulho nas sociedades secretas e enigmas hist√≥ricos de Washington D.C., com o simbologista Robert Langdon em mais uma corrida contra o tempo.\n        </p>\n        <p style=\"font-size:13px; color:#666;\"><em>Por que ler:</em> combina hist√≥ria, suspense e quebra-cabe√ßas intelectuais num ritmo eletrizante.</p>\n      </div>\n\n      <div style=\"margin-bottom:20px;\">\n        <h2 style=\"font-size:16px; color:#111; margin-bottom:4px;\">2. Guerra do Velho</h2>\n        <p style=\"margin:0; font-size:14px; color:#555;\"><strong>Autor:</strong> John Scalzi</p>\n        <p style=\"font-size:14px; color:#333; margin:8px 0;\">\n          Uma fic√ß√£o cient√≠fica envolvente em que idosos se alistam para lutar em batalhas intergal√°cticas em corpos rejuvenescidos.\n        </p>\n        <p style=\"font-size:13px; color:#666;\"><em>Por que ler:</em> mistura a√ß√£o, humor e reflex√µes sobre envelhecimento e identidade.</p>\n      </div>\n\n      <div style=\"margin-bottom:20px;\">\n        <h2 style=\"font-size:16px; color:#111; margin-bottom:4px;\">3. A Sombra do Vento</h2>\n        <p style=\"margin:0; font-size:14px; color:#555;\"><strong>Autor:</strong> Carlos Ruiz Zaf√≥n</p>\n        <p style=\"font-size:14px; color:#333; margin:8px 0;\">\n          Uma hist√≥ria misteriosa ambientada na Barcelona do p√≥s-guerra, onde um jovem descobre um livro amaldi√ßoado e um segredo que muda sua vida.\n        </p>\n        <p style=\"font-size:13px; color:#666;\"><em>Por que ler:</em> escrita po√©tica e atmosfera g√≥tica que encantam quem ama literatura e mist√©rio.</p>\n      </div>\n\n      <div style=\"margin-bottom:20px;\">\n        <h2 style=\"font-size:16px; color:#111; margin-bottom:4px;\">4. A B√∫ssola de Ouro</h2>\n        <p style=\"margin:0; font-size:14px; color:#555;\"><strong>Autor:</strong> Philip Pullman</p>\n        <p style=\"font-size:14px; color:#333; margin:8px 0;\">\n          A primeira parte da trilogia <em>Fronteiras do Universo</em>, acompanhando Lyra em uma jornada por mundos paralelos e mist√©rios cient√≠ficos.\n        </p>\n        <p style=\"font-size:13px; color:#666;\"><em>Por que ler:</em> uma fantasia profunda com questionamentos filos√≥ficos sobre f√©, liberdade e consci√™ncia.</p>\n      </div>\n\n      <div style=\"margin-bottom:20px;\">\n        <h2 style=\"font-size:16px; color:#111; margin-bottom:4px;\">5. A Guerra dos Tronos</h2>\n        <p style=\"margin:0; font-size:14px; color:#555;\"><strong>Autor:</strong> George R. R. Martin</p>\n        <p style=\"font-size:14px; color:#333; margin:8px 0;\">\n          O in√≠cio da √©pica saga de <em>As Cr√¥nicas de Gelo e Fogo</em>, onde poder, lealdade e destino colidem em um mundo medieval brutal e fascinante.\n        </p>\n        <p style=\"font-size:13px; color:#666;\"><em>Por que ler:</em> narrativa densa e personagens complexos que redefiniram o g√™nero de fantasia.</p>\n      </div>\n\n      <p style=\"font-size:14px; color:#555; margin-top:24px;\">\n        Que essas hist√≥rias te inspirem, te emocionem e te fa√ßam viajar sem sair do lugar. üåçüìñ\n      </p>\n\n      <p style=\"font-size:14px; color:#555; margin-top:20px;\">\n        Boas leituras,<br><strong>L√©o Dias</strong>\n      </p>\n    </td>\n  </tr>\n</table>\n\n</body> </html>"
      },
      {
        "row_number": 5,
        "Id": 4,
        "Subject": "Stocks",
        "ScheduledType": "MOUNTHLY",
        "ScheduledPeriod": 1,
        "ScheduledDay": 13,
        "ScheduledTime": "08:00",
        "Prompt": "Use this stock list to generate the report:\n\n US: JPM, SO, HSY, GIS, JNJ, ANET, QCOM, ADM, BAC, XOM, CVX, FAF\n BR: ITSA4, ITUB4, SEER3, LOGG3, AGRO3, SHUL4, GOLD11\n\n## üéØ INSTRU√á√ÉO PRINCIPAL\n\n**VOC√ä DEVE GERAR UM RELAT√ìRIO HTML COMPLETO E PRONTO PARA USO COM DADOS REAIS E ATUALIZADOS.**\n\n**PROIBIDO:**\n- ‚ùå Usar placeholders, vari√°veis ou templates (ex: {{VALOR}}, {PERCENTUAL}, etc.)\n- ‚ùå Deixar campos vazios ou com \"\"dados a serem preenchidos\"\"\n- ‚ùå Gerar c√≥digo JavaScript para preencher dados posteriormente\n- ‚ùå Usar dados fict√≠cios ou simulados sem avisar explicitamente\n\n**OBRIGAT√ìRIO:**\n- ‚úÖ Buscar cota√ß√µes REAIS e ATUALIZADAS de todas as a√ß√µes\n- ‚úÖ Preencher TODOS os valores com dados reais do mercado\n- ‚úÖ Usar data e hora ATUAL do momento da gera√ß√£o\n- ‚úÖ Retornar HTML 100% completo e funcional\n\n---\n\n## üìã Objetivo\nGerar um relat√≥rio completo e atualizado sobre a√ß√µes da **bolsa brasileira (B3)** e **bolsas americanas (NYSE/NASDAQ)**, formatado em HTML para envio por e-mail, com informa√ß√µes relevantes para tomada de decis√£o de investimento.\n\n---\n\n## üìä Estrutura do Relat√≥rio\n\n### Organiza√ß√£o Geral:\n\nO relat√≥rio deve ter **DUAS SE√á√ïES PRINCIPAIS** claramente separadas:\n\n1. **üáßüá∑ A√á√ïES BRASILEIRAS (B3)** - Todas as a√ß√µes do Brasil\n2. **üá∫üá∏ A√á√ïES AMERICANAS (NYSE/NASDAQ)** - Todas as a√ß√µes dos EUA\n\nCada se√ß√£o deve ter seu pr√≥prio:\n- Resumo executivo espec√≠fico (quantas subiram/ca√≠ram, maior alta, maior baixa)\n- Lista de a√ß√µes com an√°lise completa\n- Cota√ß√µes na moeda correspondente (R$ para BR, US$ para US)\n\n---\n\n### Para cada a√ß√£o, inclua:\n\n#### 1. Cabe√ßalho da A√ß√£o\n- C√≥digo e nome completo da empresa\n- Setor de atua√ß√£o\n\n#### 2. üìà Cota√ß√µes e Performance\n- Cota√ß√£o Atual (com data/hora)\n- Varia√ß√£o no Dia\n- √öltimo M√™s (30d)\n- √öltimo Ano (12m)\n- √öltimos 3 Anos\n\n#### 3. üìä Indicadores Fundamentalistas\n- P/L, Dividend Yield, P/VP, ROE\n\n#### 4. üí∞ Proventos\n- Listar proventos declarados e previstos\n\n#### 5. üì∞ Not√≠cias Relevantes\n- 3-5 not√≠cias mais relevantes dos √∫ltimos 30 dias\n\n#### 6. üéØ An√°lise T√©cnica\n- Suportes, Resist√™ncias, M√©dias M√≥veis\n\n---\n\n## ‚ö†Ô∏è REGRAS CR√çTICAS\n\n### üö´ NUNCA:\n- Use placeholders como {{VARIAVEL}}\n- Deixe dados faltando\n- Gere JavaScript para preencher depois\n\n### ‚úÖ SEMPRE:\n- Busque dados REAIS\n- Preencha TODOS os valores\n- Use data/hora ATUAL\n- Forne√ßa HTML completo\n\n---\n\n## üî¥ LEMBRETE FINAL\n\n**SE VOC√ä GERAR PLACEHOLDERS OU VARI√ÅVEIS N√ÉO PREENCHIDAS, A TAREFA SER√Å CONSIDERADA FALHADA.**\n\nRetorne APENAS HTML completo, funcional e com todos os dados preenchidos.\n\n\n### üîå APIs e Fontes de Dados Recomendadas:\n\n#### APIs Gratuitas para A√ß√µes Brasileiras (B3):\n1. **Brapi** (https://brapi.dev)\n   - API gratuita com cota√ß√µes B3 em tempo real\n   - Endpoint: \"\"https://brapi.dev/api/quote/{ticker}\"\"\n   - Exemplo: \"\"https://brapi.dev/api/quote/ITSA4\"\"\n\n2. **Yahoo Finance API**\n   - Use o sufixo \"\".SA\"\" para a√ß√µes brasileiras\n   - Exemplo: \"\"ITSA4.SA\"\", \"\"ITUB4.SA\"\"\n\n3. **HG Brasil Finance API**\n   - API brasileira com dados do mercado\n   - Cota√ß√µes, moedas e muito mais\n\n#### APIs Gratuitas para A√ß√µes Americanas (US):\n1. **Yahoo Finance API**\n   - Sem sufixo para a√ß√µes americanas\n   - Exemplo: \"\"AAPL\"\", \"\"GOOGL\"\", \"\"MSFT\"\"\n\n2. **Alpha Vantage** (https://www.alphavantage.co)\n   - API gratuita (limite de requests)\n   - Endpoint: \"\"https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol={ticker}\"\"\n\n3. **Finnhub** (https://finnhub.io)\n   - API gratuita com cota√ß√µes em tempo real\n   - Boa cobertura de a√ß√µes americanas\n\n#### Sites para Web Scraping (se necess√°rio):\n**Brasil:**\n- Status Invest (https://statusinvest.com.br)\n- Fundamentus (https://www.fundamentus.com.br)\n- InfoMoney (https://www.infomoney.com.br)\n- Investing.com Brasil (https://br.investing.com)\n\n**EUA:**\n- Yahoo Finance (https://finance.yahoo.com)\n- MarketWatch (https://www.marketwatch.com)\n- Seeking Alpha (https://seekingalpha.com)\n- Investing.com (https://www.investing.com)\n\n#### Para Not√≠cias:\n**Brasil:**\n- InfoMoney not√≠cias\n- Valor Econ√¥mico\n- B3 - Comunicados e Fatos Relevantes\n\n**EUA:**\n- Bloomberg\n- CNBC\n- Reuters\n- Yahoo Finance News\n- MarketWatch\n\n## üîî Alertas Importantes\n\nInclua alertas quando aplic√°vel:\n- ‚ö†Ô∏è Varia√ß√£o superior a ¬±5% no dia\n- üì¢ Resultados trimestrais divulgados recentemente\n- üíµ Proventos com data de pagamento pr√≥xima (pr√≥ximos 7 dias)\n- üî• Not√≠cias de alto impacto (fus√µes, aquisi√ß√µes, mudan√ßas estrat√©gicas)\n\n\n## üî¥ LEMBRETE FINAL - LEIA NOVAMENTE\n\n### ESTE PROMPT EXIGE:\n\n1. **HTML COMPLETO** - Pronto para abrir no navegador e enviar por e-mail\n2. **DADOS REAIS** - Busque cota√ß√µes, not√≠cias e indicadores atualizados\n3. **ZERO PLACEHOLDERS** - Nenhum \"\"{{VARIAVEL}}\"\", \"\"{VALOR}\"\" ou similar\n4. **SEM JAVASCRIPT** - N√£o gere scripts para preencher dados depois\n5. **DATA ATUAL** - Use a data e hora real do momento da gera√ß√£o\n\n### SE VOC√ä GERAR PLACEHOLDERS OU VARI√ÅVEIS N√ÉO PREENCHIDAS, A TAREFA SER√Å CONSIDERADA FALHADA.\n\n`\""
      },
      {
        "row_number": 6,
        "Id": 5,
        "Subject": "Budismo",
        "ScheduledType": "DAILY",
        "ScheduledPeriod": 1,
        "ScheduledDay": 1,
        "ScheduledTime": "08:00",
        "Prompt": "Gere apenas HTML, sem Markdown, sem ``` e sem texto explicativo.\n\nCrie um e-mail com o seguinte formato:\n\nAssunto: ‚ÄúSabedoria Budista‚Äù\n\nCumprimento e breve introdu√ß√£o inspiradora.\n\nListe 5 frases sobre o Budismo\n\na frase em destaque,\n\no autor,\n\ne uma breve reflex√£o sobre seu significado.\n\nFinalize com uma despedida\n\nUse HTML inline (sem classes ou CSS externo).\n\nEstruture assim (responda apenas com o HTML completo):\n\n(n√£o inclua este coment√°rio no resultado)\n\n<html> <body style=\"font-family: Arial, sans-serif; color:#222; margin:0; padding:24px; background:#f9fafb;\"> <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"max-width:700px; margin:auto; background:#ffffff; border:1px solid #e5e7eb; border-radius:8px;\"> <tr> <td style=\"padding:24px;\"> <h1 style=\"font-size:20px; margin-bottom:8px;\">Sabedoria Estoica para o Dia a Dia</h1> <p style=\"font-size:14px; color:#555;\">Ol√° [Nome do Destinat√°rio],</p> <p style=\"font-size:14px; color:#555; margin-bottom:20px;\"> Espero que este e-mail te encontre bem! Separei cinco frases de grandes fil√≥sofos estoicos que nos lembram o valor da serenidade, da raz√£o e do foco no que podemos controlar. </p>\n      <ol style=\"padding-left:20px; margin-bottom:24px; font-size:14px; color:#333;\">\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúAlgumas coisas est√£o sob nosso controle, e outras n√£o.‚Äù</strong> ‚Äî <em>Epicteto</em><br>\n          <span style=\"color:#666;\">Um lembrete poderoso para concentrar nossa energia apenas no que depende de n√≥s.</span>\n        </li>\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúO obst√°culo para a a√ß√£o avan√ßa a a√ß√£o. O que est√° no caminho torna-se o caminho.‚Äù</strong> ‚Äî <em>Marco Aur√©lio</em><br>\n          <span style=\"color:#666;\">Um convite para transformar desafios em oportunidades de crescimento.</span>\n        </li>\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúSofremos mais frequentemente na imagina√ß√£o do que na realidade.‚Äù</strong> ‚Äî <em>S√™neca</em><br>\n          <span style=\"color:#666;\">Um lembrete para n√£o deixar que preocupa√ß√µes irreais dominem nossa mente.</span>\n        </li>\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúN√£o √© o que acontece com voc√™ que importa, mas como voc√™ reage a isso.‚Äù</strong> ‚Äî <em>Epicteto</em><br>\n          <span style=\"color:#666;\">A ess√™ncia da resili√™ncia ‚Äî o poder est√° sempre em nossa resposta.</span>\n        </li>\n        <li style=\"margin-bottom:16px;\">\n          <strong>‚ÄúN√£o deseje que as coisas aconte√ßam do seu jeito, mas deseje que elas aconte√ßam como acontecem.‚Äù</strong> ‚Äî <em>Epicteto</em><br>\n          <span style=\"color:#666;\">Aceitar a realidade como ela √© nos aproxima da verdadeira paz interior.</span>\n        </li>\n      </ol>\n\n      <p style=\"font-size:14px; color:#555;\">\n        Que essas reflex√µes tragam um pouco de calma e clareza ao seu dia.\n      </p>\n\n      <p style=\"font-size:14px; color:#555; margin-top:20px;\">Com serenidade,<br><strong>L√©o Dias</strong></p>\n    </td>\n  </tr>\n</table>\n\n</body> </html>"
      },
      {
        "row_number": 7,
        "Id": 6,
        "Subject": "Dica n8n",
        "ScheduledType": "DAILY",
        "ScheduledPeriod": 1,
        "ScheduledDay": 1,
        "ScheduledTime": "08:00",
        "Prompt": "Dicas n8n"
      }
    ];

    // ========================================
    // EDITE AQUI: Hist√≥rico de execu√ß√µes
    // ========================================
    const executions = [
      { Id: 1, ExecutionTime: '13/11/2025 08:30:00', Saida: 'Output da execu√ß√£o' }
    ];

    // ========================================
    // EDITE AQUI: Emails por task
    // ========================================
    const emails = [
      { Id: 1, email: 'ldias.rs@gmail.com' },
      { Id: 1, email: 'ldias4@gmail.com' },
      { Id: 2, email: 'ldias.rs@gmail.com' },
      { Id: 5, email: 'ldias.rs@gmail.com' },
      { Id: 6, email: 'ldias4@gmail.com' },
    ];

    // ========================================
    // EDITE AQUI: Data/hora do teste
    // ========================================
    // Formato: new Date(ano, m√™s-1, dia, hora, minuto)
    // Exemplo: new Date(2025, 10, 10, 17, 0) = 10/11/2025 √†s 17:00
    const today = new Date(2025, 10, 13, 9, 0); // Segunda-feira, 10/11/2025 √†s 17:00

    // ========================================
    // Executar filtro
    // ========================================
    const result = filterTasksToExecute(tasks, executions, emails, today);

    // ========================================
    // Resultados
    // ========================================
    console.log('\nüìã RESULTADO DO TESTE:');
    console.log(`Total de tasks para executar: ${result.length}`);
    
    const report =result.map(task => {
      return `\n‚úÖ Task ID ${task.Id}: ${task.Subject} - Emails: ${task.Emails.join(', ')}`
    });

    console.log(report);
    // Valida√ß√µes b√°sicas
    expect(result).toBeInstanceOf(Array);
    result.forEach(task => {
      expect(task).toHaveProperty('Id');
      expect(task).toHaveProperty('Subject');
      expect(task).toHaveProperty('Prompt');
      expect(task).toHaveProperty('Emails');
      expect(task).toHaveProperty('HistoryCount');
    });
  });
});
